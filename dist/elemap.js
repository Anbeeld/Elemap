var Elemap;(()=>{"use strict";var t={d:(i,e)=>{for(var s in e)t.t(e,s)&&!t.t(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:e[s]})},t:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)},i={};(()=>{t.d(i,{default:()=>Gt});class e{constructor(){}get i(){return Y.map.h(this.ids.i)}get o(){return{u:".elemap"}}}function s(t){return Array.isArray(t)?{width:t[0],height:t[1]}:t}var r,n,h;function o(t){return void 0!==t.x&&void 0!==t.y}function u(t){return void 0!==t.l&&void 0!==t.r?t.l:t.y}function l(t,i){return parseFloat(t.toFixed(i))}!function(t){t.p="rectangle",t.m="hexagon"}(r||(r={})),function(t){t.$="pointy",t.v="flat"}(n||(n={})),function(t){t.C="odd",t.T="even"}(h||(h={}));const d=2/Math.sqrt(3);function a(t,i,e=0,s={top:0,left:0}){const r=Math.sin(30*Math.PI/180);const h=Math.cos(30*Math.PI/180),o=T(i.S),u=T(i.q)/(o*h*2),d=T(i.A)/(2*o);let a=0,c=0,f=l(o*h*u,2),p=l(o*r*d,2),g=l(f-e*h*u,2),m=l(e*r*d,2),x=l(f+e*h*u,2),$=l(2*f,2),y=l(p+o,2),v=l($-e*h*u,2),w=l(p-e*r*d,2),b=l(p+e*d,2),C=l(y+p,2),E=l(y-e*d,2),S=l(y+e*r*d,2),q=l(C-e*r*d,2),z=l(e*h*u,2);if(t===n.$)return a=l(a+s.left,2),f=l(f+s.left,2),g=l(g+s.left,2),x=l(x+s.left,2),$=l($+s.left,2),v=l(v+s.left,2),z=l(z+s.left,2),c=l(c+s.top,2),p=l(p+s.top,2),m=l(m+s.top,2),w=l(w+s.top,2),b=l(b+s.top,2),y=l(y+s.top,2),E=l(E+s.top,2),S=l(S+s.top,2),C=l(C+s.top,2),q=l(q+s.top,2),`M ${g},${m}Q ${f},${c} ${x},${m} L ${v},${w}Q ${$},${p} ${$},${b} L ${$},${E}Q ${$},${y} ${v},${S} L ${x},${q}Q ${f},${C} ${g},${q} L ${z},${S}Q ${a},${y} ${a},${E} L ${a},${b}Q ${a},${p} ${z},${w} Z`;if(t===n.v)return a=l(a+s.top,2),f=l(f+s.top,2),g=l(g+s.top,2),x=l(x+s.top,2),$=l($+s.top,2),v=l(v+s.top,2),z=l(z+s.top,2),c=l(c+s.left,2),p=l(p+s.left,2),m=l(m+s.left,2),w=l(w+s.left,2),b=l(b+s.left,2),y=l(y+s.left,2),E=l(E+s.left,2),S=l(S+s.left,2),C=l(C+s.left,2),q=l(q+s.left,2),`M ${m},${g}Q ${c},${f} ${m},${x} L ${w},${v}Q ${p},${$} ${b},${$} L ${E},${$}Q ${y},${$} ${S},${v} L ${q},${x}Q ${C},${f} ${q},${g} L ${S},${z}Q ${y},${a} ${E},${a} L ${b},${a}Q ${p},${a} ${w},${z} Z`;throw new Error("Invalid hexagon type")}function c(t,i=0,e={top:0,left:0}){let s=0,r=0,n=s+i,h=r+i,o=T(t.width),u=o-i,d=T(t.height),a=d-i;return s=l(s+e.left,2),o=l(o+e.left,2),u=l(u+e.left,2),n=l(n+e.left,2),r=l(r+e.top,2),d=l(d+e.top,2),h=l(h+e.top,2),a=l(a+e.top,2),`M ${s},${h}A ${i},${i} 0 0 1 ${n},${r} L ${u},${r}A ${i},${i} 0 0 1 ${o},${h} L ${o},${a}A ${i},${i} 0 0 1 ${u},${d} L ${n},${d}A ${i},${i} 0 0 1 ${s},${a} Z`}function f(t,i,e){let s={r:0,l:0};return i===n.$?(s.r=t.y,e===h.C?s.l=t.x-(t.y-(1&t.y))/2:s.l=t.x-(t.y+(1&t.y))/2):(s.l=t.x,e===h.C?s.r=t.y-(t.x-(1&t.x))/2:s.r=t.y-(t.x+(1&t.x))/2),s}function p(t,i,e){let s={x:0,y:0};return i===n.$?(s.y=t.r,e===h.C?s.x=t.l+(t.r-(1&t.r))/2:s.x=t.l+(t.r+(1&t.r))/2):(s.x=t.l,e===h.C?s.y=t.r+(t.l-(1&t.l))/2:s.y=t.r+(t.l+(1&t.l))/2),s}function g(t){return t&&"object"==typeof t&&!Array.isArray(t)}function m(t,...i){if(!i.length)return t;const e=i.shift();if(g(t)&&g(e))for(const i in e)g(t[i])&&g(e[i])?m(t[i],e[i]):Object.assign(t,{[i]:e[i]});return m(t,...i)}class x{*[Symbol.iterator](){for(const t of this.keys)yield[t,this[t]]}get keys(){let t=[];for(const i of Object.keys(this)){let e;if("string"==typeof i){if(!v(i))continue;e=Number(i)}else{if("number"!=typeof i)continue;e=i}t.push(e)}return t.sort(((t,i)=>t-i)),t}get values(){let t=[];for(const i of this.keys)t.push(this[i]);return t}get length(){return this.keys.length}delete(t){return t in this.keys&&(delete this[t],!0)}}class $ extends x{delete(t){return"number"==typeof t?t in this.keys&&(delete this[t],!0):t[0]in this.keys&&t[1]in this[t[0]].keys&&(delete this[t[0]][t[1]],0===this[t[0]].length&&delete this[t[0]],!0)}}function y(t){let i=new x;if(g(t))for(const e in t)i[Number(e)]=t[e];return i}function v(t){return"string"==typeof t&&!isNaN(Number(t))}function w(t){if(t.constructor===Array){let i=t;t={};for(let[e,s]of i){let i=e.split("."),r=t;for(let t of i.slice(0,i.length-1))r[t]||(r[t]={}),r=r[t];r[i[i.length-1]]=s}}return t}function b(t,i){for(let e of i){let i=e.split("."),s=t;for(let t of i.slice(0,i.length-1))s=s[t];delete s[i[i.length-1]]}}function C(t){const{tagName:i,id:e,className:s,parentNode:r}=t;if("HTML"===i)return"HTML";let n=i;if(n+=""!==e?`#${e}`:"",s){const t=s.split(/\s/);for(let i=0;i<t.length;i++)n+=`.${t[i]}`}let h=1;for(let i=t;i.previousElementSibling;i=i.previousElementSibling)h+=1;return n+=`:nth-child(${h})`,`${C(r)} > ${n}`}function E(t,i,e){return t.replace(new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(i),"g"),e)}function T(t){return t.endsWith("px")?Number(t.slice(0,-2)):Number(t)}function S(t){if("number"==typeof t)return t;if(v(t))return Number(t);if(t.endsWith("px")&&v(t.slice(0,-2)))return Number(t.slice(0,-2));throw new Error(`Invalid calc value: ${t}`)}function q(t){return"number"==typeof t||"string"==typeof t&&(!!v(t)||!(!t.endsWith("px")||!v(t.slice(0,-2))))}function z(t){return t.every(q)}const A=(...t)=>{if(void 0===t[0]||0===t.length)return"0px";if(void 0===t[1]||1===t.length)return`${S(t[0])}px`;if(z(t)){let i=S(t[0]);for(let e=1;e<t.length;e++)i+=S(t[e]);return`${l(i,4)}px`}return`calc(${t.join(" + ")})`},I=function(...t){if(void 0===t[0]||0===t.length)return"0px";if(void 0===t[1]||1===t.length)return`${S(t[0])}px`;if(z(t)){let i=S(t[0]);for(let e=1;e<t.length;e++)i-=S(t[e]);return`${l(i,4)}px`}return`calc(${t.join(" - ")})`},M=(...t)=>{if(void 0===t[0]||0===t.length)return"0px";if(void 0===t[1]||1===t.length)return`${S(t[0])}px`;if(z(t)){let i=S(t[0]);for(let e=1;e<t.length;e++)i*=S(t[e]);return`${l(i,4)}px`}return`calc(${t.join(" * ")})`},P=(...t)=>{if(void 0===t[0]||0===t.length)return"0px";if(void 0===t[1]||1===t.length)return`${S(t[0])}px`;if(z(t)){let i=S(t[0]);for(let e=1;e<t.length;e++)i/=S(t[e]);return`${l(i,4)}px`}return`calc(${t.join(" / ")})`},N=(t,i)=>`${l(S(t),i)}px`;class O extends e{set ids(t){this.I=t}get ids(){return this.I}get i(){return Y.grid.h(this.ids.i)}get map(){return Y.style.map.grid(this.ids.i)}set M(t){this.P=t}get M(){return this.P}set N(t){this.O=t}get N(){return this.O}set R(t){this.L=t}get R(){return this.L}constructor(t,i,e){super(),this.ids=new j(t,i,Y.id()),this.k(e.R),this.M=e.grid}get o(){let t=".elemap",i=t+"-grid",e='[data-map-id="'+this.ids.i.map+'"]';return{u:t,frame:i+"-frame"+e,F:i+"-frame-outer"+e,B:i+"-frame-inner"+e,grid:i+e,H:i+e+" ."+this.i.j.H,R:i+e+" ."+this.i.j.R,G:i+"-outer"+e,Y:i+"-inner"+e,X:i+"-outer"+e+" ."+this.i.j.H,Z:i+"-inner"+e+" ."+this.i.j.H,W:i+"-outer"+e+" ."+this.i.j.R,D:i+"-inner"+e+" ."+this.i.j.R,V:i+"-contour"+e,J:t+"-mannequin"+e,K:t+"-tile-hidden"}}get spacing(){return M(this.R.N.inner.marginRight,2)}get U(){return this.o.F+"{display:block;position:absolute;z-index:50;}"+this.o.B+"{position:absolute;top:0;left:0;bottom:0;right:0;z-index:55;}"+this.o.J+"{display:none!important;}"+this.o.grid+"{overflow:visible;}"+this.o.H+"{position:absolute;left:0;right:auto;bottom:auto;pointer-events:none;}"+this.o.R+"{pointer-events:auto;float:left;}"+this.o.G+"{position:absolute;z-index:100;}"+this.o.X+"{z-index:110;}"+this.o.W+"{position:absolute;z-index:120;}"+this.o.W+":before{z-index:130;}"+this.o.W+":after{z-index:140;}"+this.o.Y+"{position:relative;z-index:150;}"+this.o.Z+"{z-index:160;}"+this.o.D+"{position:absolute;z-index:170;}"+this.o.D+":after{z-index:190;}"+this.o.D+">*{position:relative;z-index:200;}"+this.o.V+"{display:block;position:absolute;z-index:210;pointer-events:none;}"+this.o.V+">div{display:block;position:absolute;z-index:220;}"+this.o.K+"{opacity: 0;}"}get _(){return this.o.F+"{"+this.M.frame.tt+"}"+this.o.B+"{"+this.M.frame.inner+"}"+this.o.V+">div{"+this.M.V+"}"}get it(){let t=`{top: ${this.map.N.map.paddingTop};right: ${this.map.N.map.paddingRight};bottom: ${this.map.N.map.paddingBottom};left: ${this.map.N.map.paddingLeft};}`;return this.o.grid+"{"+`margin:${P(this.spacing,2)};`+`width: ${this.et.width};`+`height:${this.et.height};}`+this.o.F+t+this.o.G+t+this.o.V+t+this.o.V+"{"+`margin:${P(this.spacing,2)};}`+this.o.H+"{"+`height:${this.R.size.tt.height};`+`width: ${this.st.width};}`+this.o.W+"{"+`width:${this.R.size.tt.width};`+`height:${this.R.size.tt.height};}`+this.o.V+">div{display:none;top:0;left:0;"+`width:${this.R.size.rt.width};`+`height:${this.R.size.rt.height};}`+this.o.B+"{"+`clip-path: path('${this.nt}');}`+this.ht+this.ot+this.ut}get ht(){let t="",i=this.i.lt;for(let e=i.y.min;e<=i.y.max;e++)this.i.tiles[e]&&(t+=this.o.H+`[data-coords-y="${e}"]{`+`top:${M(e-i.y.min,this.R.size.tt.height)};}`);return t}compute(){this.N={tt:getComputedStyle(this.i.elements.tt),inner:getComputedStyle(this.i.elements.inner),dt:getComputedStyle(this.i.elements.dt)},this.R.compute()}get st(){return{width:M(this.R.size.tt.width,this.i.size.width),height:this.R.size.tt.height}}get et(){return{width:this.st.width,height:M(this.R.size.tt.height,this.i.size.height)}}ct(t){return{top:M(t.y-this.i.lt.y.min,this.R.size.tt.height),left:M(t.x-this.i.lt.x.min,this.R.size.tt.width)}}ft(t){let i=this.ct(t);return{top:A(i.top,P(this.spacing,2)),left:A(i.left,P(this.spacing,2))}}get ot(){let t="";for(let i of this.i.tiles.values)for(let e of i.values)t+=this.o.R+e.o.data+"{"+`left:${this.ct(e.gt).left};}`;return t}get xt(){return{top:A(this.map.N.map.paddingTop,P(this.spacing,2)),left:A(this.map.N.map.paddingLeft,P(this.spacing,2))}}$t(){for(let t of this.i.tiles.values)for(let i of t.values)i.yt()}}class R{constructor(t){this.map=t}}class L extends R{}class k extends L{constructor(t,i){super(t.map),this.grid=i}}class Q extends k{constructor(t,i){super(t,t.grid),this.R=i}}class F extends L{constructor(t,i){super(t.map),this.content=i}}class B{constructor(t,i){this.i=t,this.map=i}}class H extends B{}class j extends H{constructor(t,i,e){super(t,i.map),this.grid=e}}class G extends j{constructor(t,i,e){super(t,i,e),this.R=e}}class Y{static id(){return Y.vt++}static add(t){Y.wt.set(t.ids.map,t)}static update(t){t>Y.vt&&(Y.vt=t)}static content(t){let i=Y.map.h(t);if(i)return i.contentById(t)}}function X(t,i){if(t&&t.hasOwnProperty(i))return t[i]}function Z(t,i,e){if(t)return t[i]=e,t}function W(t,i){for(let e of i)Z(t,e[0],e[1]);return t}function D(t){let i={};return Z(i,"map",t.map),i}function V(t){let i={};return Z(i,"map",t.map),Z(i,"grid",t.grid),i}function J(t){return{map:X(t,"map"),grid:X(t,"grid")}}function K(t){let i={};return Z(i,"map",t.map),Z(i,"grid",t.grid),Z(i,"tile",t.R),i}function U(t){return{map:X(t,"map"),grid:X(t,"grid"),R:X(t,"tile")}}function _(t){let i={};return Z(i,"map",t.map),Z(i,"content",t.content),i}function tt(t){return{map:X(t,"map"),content:X(t,"content")}}function it(t){let i={};return t&&(t.content?i=_(t):t.R&&(i=K(t))),i}function et(t){return W({},[["outer",t.tt],["inner",t.inner]])}function st(t){return{tt:X(t,"outer"),inner:X(t,"inner")}}function rt(t){return W({},[["frame",et(t.frame)],["contour",t.V]])}function nt(t){return{frame:st(X(t,"frame")),V:X(t,"contour")}}function ht(t){return W({},[["outer",t.tt],["inner",t.inner],["hover",W({},[["outer",t.bt.tt],["inner",t.bt.inner]])]])}function ot(t){return{tt:X(t,"outer"),inner:X(t,"inner"),bt:{tt:X(X(t,"hover"),"outer"),inner:X(X(t,"hover"),"inner")}}}function ut(t){return{grid:nt(X(t,"grid")),R:ot(X(t,"tile"))}}function lt(t){return{map:st(X(t,"map")),grid:nt(X(t,"grid")),R:ot(X(t,"tile"))}}function dt(t){return void 0!==X(t,"q")&&void 0!==X(t,"r")?{l:X(i=t,"q"),r:X(i,"r")}:function(t){return{x:X(t,"x"),y:X(t,"y")}}(t);var i}function at(t){return void 0!==t.l&&void 0!==t.r?function(t){let i={};return Z(i,"q",t.l),Z(i,"r",t.r),i}(t):function(t){let i={};return Z(i,"x",t.x),Z(i,"y",t.y),i}(t)}Y.vt=0,Y.wt=new Map,Y.map={h:t=>Y.wt.get(t.map),grid:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i}},Y.grid={h:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i.grid},Ct:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i.grid},Et:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i.grid}},Y.R={h:t=>{let i=Y.grid.h(t);if(i)return i.Tt(t)}},Y.style={map:{grid:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i.style}},grid:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct)return i.style.grid},R:t=>{let i=Y.map.h(t);if(i&&i instanceof Ct&&i.style.grid&&i.style.grid instanceof O)return i.style.grid.R}};const ct={tt:"padding:50px;background-color:#f5df8d;",inner:""};function ft(t,i){return{tt:(i&&i.tt?i.tt:"")+(t.tt||""),inner:(i&&i.inner?i.inner:"")+(t.inner||"")}}const pt={frame:{tt:"",inner:"background-color:#222222;"},V:"border: 2px solid transparent;background-color:#f5f5f5;"};function gt(t,i){return{frame:{tt:(i&&i.frame&&i.frame.tt?i.frame.tt:"")+(t.frame&&t.frame.tt?t.frame.tt:""),inner:(i&&i.frame&&i.frame.inner?i.frame.inner:"")+(t.frame&&t.frame.inner?t.frame.inner:"")},V:(i&&i.V?i.V:"")+(t.V||"")}}const mt={tt:"background-color:#222222;",inner:"width:100px;height:100px;border-radius:6px;background-color:#b2e090;margin:2px;",bt:{tt:"background-color:#f5f5f5;",inner:""}};function xt(t,i,e){return!0===e?{tt:t.tt?"clear"===t.tt?"":i&&i.tt?E(i.tt,t.tt,""):"":i&&i.tt?i.tt:"",inner:t.inner?"clear"===t.inner?"":i&&i.inner?E(i.inner,t.inner,""):"":i&&i.inner?i.inner:"",bt:{tt:t.bt&&t.bt.tt?"clear"===t.bt.tt?"":i&&i.bt&&i.bt.tt?E(i.bt.tt,t.bt.tt,""):"":i&&i.bt&&i.bt.tt?i.bt.tt:"",inner:t.bt&&t.bt.inner?"clear"===t.bt.inner?"":i&&i.bt&&i.bt.inner?E(i.bt.inner,t.bt.inner,""):"":i&&i.bt&&i.bt.inner?i.bt.inner:""}}:{tt:(i&&i.tt?i.tt:"")+(t.tt||""),inner:(i&&i.inner?i.inner:"")+(t.inner||""),bt:{tt:(i&&i.bt&&i.bt.tt?i.bt.tt:"")+(t.bt&&t.bt.tt?t.bt.tt:""),inner:(i&&i.bt&&i.bt.inner?i.bt.inner:"")+(t.bt&&t.bt.inner?t.bt.inner:"")}}}class $t{set ids(t){this.I=t}get ids(){return this.I}get grid(){return Y.grid.h(this.ids)}set style(t){this.St=t}get style(){return void 0!==this.St?this.St:Y.style.R(this.ids)}get M(){return this.style.M}set elements(t){this.qt=t}get elements(){return this.qt}set coords(t){this.zt=t}get coords(){return this.zt}set visible(t){this.At=t}get visible(){return this.At}set extensions(t){this.It=t}get extensions(){return this.It}constructor(t){this.Mt=!1,this.At=!0,this.It={},"number"==typeof t.ids.R?(this.ids=new Q(t.ids,t.ids.R),Y.update(this.ids.R)):this.ids=new Q(t.ids,Y.id()),this.coords=t.coords,!1===t.visible&&(this.visible=t.visible),t.M&&"mannequin"!==t.M&&this.updateStyle(t.M)}static Pt(t,i){let e=function(t){return{ids:U(X(t,"ids")),coords:dt(X(t,"coords")),M:!!X(t,"decls")&&ot(X(t,"decls")),visible:X(t,"visible"),extensions:X(t,"extensions")}}(i),s=new t(e);return s.Nt(e.extensions),s}Nt(t){m(this.extensions,t)}Ot(t){b(this.extensions,t)}Rt(){return this.Lt(this.kt())}kt(t={}){return W(t,[["ids",K(this.ids)],["coords",at(this.coords)],["decls",void 0!==this.St&&ht(this.M)],["visible",this.visible]]),t}Lt(t={}){return W(t,[["extensions",this.extensions]]),t}updateStyle(t,i="add"){"remove"===i?this.St&&(this.style=this.Qt(xt(t,this.M,!0))):void 0===this.St||"replace"===i?this.style=this.Qt(xt(t)):this.style=this.Qt(xt(t,this.M)),this.grid.map.Ft&&this.Mt&&(this.render(),this.yt())}Bt(){this.elements||(this.elements={inner:document.createElement("div")},this.elements.inner.classList.add(this.grid.j.R))}render(){var t,i;if(this.style.J&&this.style.i===this)this.Ht();else{let t=this.grid.elements.jt[u(this.gt)],i=this.grid.elements.Gt[u(this.gt)];this.Bt(),this.Yt(),this.elements.tt&&(t.contains(this.elements.tt)||t.appendChild(this.elements.tt)),i.contains(this.elements.inner)||i.appendChild(this.elements.inner)}this.visible?(null===(i=this.elements.tt)||void 0===i||i.classList.remove(this.grid.j.K),this.elements.inner.classList.remove(this.grid.j.K)):(null===(t=this.elements.tt)||void 0===t||t.classList.add(this.grid.j.K),this.elements.inner.classList.add(this.grid.j.K)),this.Mt=!0}Ht(){let t=this.grid.elements.J.X,i=this.grid.elements.J.Z;this.elements||(this.elements={inner:document.createElement("div"),tt:document.createElement("div")}),this.elements.inner.classList.add(this.grid.j.R),this.elements.tt.classList.add(this.grid.j.R),this.elements.tt.classList.add(this.grid.j.J),this.grid.map.Xt(this.elements.tt),this.elements.inner.classList.add(this.grid.j.J),this.grid.map.Xt(this.elements.inner),t.contains(this.elements.tt)||t.appendChild(this.elements.tt),i.contains(this.elements.inner)||i.appendChild(this.elements.inner)}yt(){if(void 0!==this.St&&!this.style.J){if(!this.elements.style){let t=document.head.getElementsByTagName("style");for(let i of t)i.classList.contains("elemap-"+this.ids.map+"-css-tile-"+this.ids.R)&&i.hasAttribute("data-map-id")&&i.getAttribute("data-map-id")===this.ids.map.toString()&&i.hasAttribute("data-tile-id")&&i.getAttribute("data-tile-id")===this.ids.R.toString()&&(this.elements.style=i);this.elements.style||(this.elements.style=document.createElement("style"),this.elements.style.classList.add("elemap-css-tile"),this.grid.map.Xt(this.elements.style),this.Xt(this.elements.style),document.head.appendChild(this.elements.style))}if(!this.elements.tt&&(this.M.tt.length||this.M.bt.tt.length)){this.elements.tt=document.createElement("div"),this.elements.tt.classList.add(this.grid.j.R);let t=this.grid.elements.jt[u(this.gt)];this.Yt(),this.elements.tt&&(t.contains(this.elements.tt)||t.appendChild(this.elements.tt))}}this.elements.style&&(this.elements.style.innerHTML=this.style.U+this.style._+this.style.it)}Xt(t){Z(t.dataset,"tileId",this.ids.R.toString())}bt(){if(!this.visible)return;let t=Y.grid.h(this.ids);t&&t.Zt(this.Wt)}Dt(){let t=Y.grid.h(this.ids);t&&t.Zt(!1)}get Wt(){let t=Y.grid.h(this.ids);if(t){let i=this.elements.inner,e={x:0,y:0};for(;i;)if(e.x+=i.offsetLeft,e.y+=i.offsetTop,i=i.parentElement,i===t.elements.inner)return{x:e.x-T(t.style.spacing),y:e.y-T(t.style.spacing)}}return{x:0,y:0}}toggleVisibility(t){return this.visible=void 0!==t?t:!this.visible,this.grid.map.Ft&&this.Mt&&this.grid.map.render(),this.visible}}class yt{set ids(t){this.I=t}get ids(){return this.I}get map(){return Y.map.h(this.ids)}set Vt(t){this.Jt=t}get Vt(){return this.Jt}set location(t){this.Kt=t}get location(){return this.Kt}get host(){return this.Kt.content?Y.content(this.Kt):this.Kt.R?Y.R.h(this.Kt):void 0}set offset(t){this.Ut=t}get offset(){return this.Ut}set elements(t){this.qt=t}get elements(){return this.qt}set extensions(t){this.It=t}get extensions(){return this.It}constructor(t){this.Kt=void 0,this.It={},"number"==typeof t.ids.content?(this.ids=new F(t.ids,t.ids.content),Y.update(this.ids.content)):this.ids=new F(t.ids,Y.id()),"string"==typeof t.Vt?this.Vt=t.Vt:this.Vt=C(t.Vt),this.location=t.location,this.offset=t.offset}static import(t){let i=function(t){return{ids:tt(X(t,"ids")),Vt:X(t,"figure"),location:(i=X(t,"location"),i?X(i,"content")?tt(i):X(i,"tile")?U(i):void 0:void 0),offset:X(t,"offset"),extensions:X(t,"extensions")};var i}(t),e=new yt(i);return e.Nt(i.extensions),e}Nt(t){m(this.extensions,t)}Ot(t){b(this.extensions,t)}export(){return this.Lt(this.kt())}kt(t={}){return W(t,[["ids",_(this.ids)],["figure",this.elements&&this.elements.Vt?this.elements.Vt.outerHTML:this.Vt],["location",this.location?it(this.location):void 0],["offset",this.offset]]),t}Lt(t={}){return W(t,[["extensions",this.extensions]]),t}bt(){this.host&&"function"==typeof this.host.bt&&this.host.bt()}Dt(){this.host&&"function"==typeof this.host.Dt&&this.host.Dt()}Bt(){if(this.elements)return;let t,i=document.createElement("div"),e=document.createElement("div");i.appendChild(e);try{t=document.querySelector(this.Vt)}catch(t){}if(!t){let i=document.createElement("div");i.innerHTML=this.Vt,t=i.children[0]}t.addEventListener("mouseover",(()=>this.bt()),!1),t.addEventListener("mouseout",(()=>this.Dt()),!1),e.appendChild(t),this.elements={position:i,container:e,Vt:t}}render(){if(this.Bt(),this.host&&this.host instanceof $t){let t=this.host.style.grid.xt,i=this.host.style.grid.ft(this.host.gt),e=this.host.style.size.inner;this.elements.position.style.top=A(t.top,i.top,this.offset.top,P(e.height,2)),this.elements.position.style.left=A(t.left,i.left,this.offset.top,P(e.width,2))}this.map.elements.content.contains(this.elements.position)||this.map.elements.content.appendChild(this.elements.position)}}class vt{constructor(t){this._t=t}get ids(){return _(this._t.ids)}Nt(t){return this._t.Nt(w(t))}Ot(t){return this._t.Ot(t)}get extensions(){return this._t.extensions}}class wt{constructor(t){this._t=t}get ids(){return K(this._t.ids)}get coords(){return at(this._t.coords)}export(){return this._t.export()}get extensions(){return this._t.extensions}Nt(t){return this._t.Nt(w(t))}Ot(t){return this._t.Ot(t)}updateStyle(t,i="add"){this._t.updateStyle(ot(t),i)}get elements(){let t={};return W(t,[["outer",this._t.elements.tt||void 0],["inner",this._t.elements.inner||void 0]]),t}toggleVisibility(t){return this._t.toggleVisibility(t)}get neighborCoords(){let t=[];for(let i of this._t.neighborCoords)t.push(at(i));return t}get neighbors(){let t=[];for(let i of this._t.neighbors)t.push(new wt(i));return t}get diagonalCoords(){let t=[];for(let i of this._t.diagonalCoords)t.push(at(i));return t}get diagonals(){let t=[];for(let i of this._t.diagonals)t.push(new wt(i));return t}distanceToCoords(t,i=!1){return Array.isArray(t)||(t=at(t)),this._t.distanceToCoords(t,i)}alignedWithCoords(t,i=!1){return Array.isArray(t)||(t=at(t)),this._t.alignedWithCoords(t,i)}}class bt{set ids(t){this.I=t}get ids(){return this.I}set elements(t){this.qt=t}get elements(){return this.qt}set style(t){this.St=t}get style(){return this.St}get j(){let t="elemap-";return{u:t,container:t+"container",map:t+"map",content:t+"content"}}Xt(t){Z(t.dataset,"mapId",this.ids.map.toString())}set extensions(t){this.It=t}get extensions(){return this.It}set contents(t){this.ti=t}get contents(){return this.ti}set Ft(t){this.ii=t}get Ft(){return this.ii}set Mt(t){this.ei=t}get Mt(){return this.ei}constructor(t){this.It={},this.ti=[],this.ii=!1,this.ei=!1,t.ids&&"number"==typeof t.ids.map?(this.ids=new L(t.ids.map),Y.update(this.ids.map)):this.ids=new L(Y.id()),Y.add(this),t.contents&&this.si(t.contents)}Rt(){return this.Lt(this.kt())}kt(t={}){return W(t,[["type",this.ri()],["ids",D(this.ids)],["contents",this.contents.map((t=>t.export()))]]),t}Lt(t={}){return W(t,[["extensions",this.extensions]]),t}si(t){for(let i of t)this.contents.push(yt.import(i))}Bt(){if(this.elements&&this.elements.map)return this.elements;{let t=document.createElement("div");t.classList.add(this.j.map),this.Xt(t);let i=document.createElement("div");return i.classList.add(this.j.content),this.Xt(i),{map:t,content:i}}}ni(t){if(t&&this.elements.container!==t&&(this.elements.container=t,this.elements.container.innerHTML="",this.elements.container.classList.add(this.j.container),this.Xt(this.elements.container)),!this.elements.container)throw new Error("No container found.");for(let t of document.getElementsByClassName(this.j.container))t!==this.elements.container&&(t.classList.remove(this.j.container),t.removeAttribute("data-map-id"));this.elements.container.appendChild(this.elements.map),this.elements.container.appendChild(this.elements.content)}render(t){this.elements=this.Bt(),this.ni(t),this.style.render(),this.Mt=!0;for(let t of this.contents)t.render()}contentById(t){for(let i of this.contents)if(i.ids.content===t.content)return i}contentByElement(t){for(let i of this.contents)if(i.elements&&(i.elements.Vt&&i.elements.Vt===t||i.elements.position&&i.elements.position===t||i.elements.container&&i.elements.container===t))return i}addContent(t){let i;i=(t=function(t){return{Vt:X(t,"figure"),location:X(t,"location"),offset:X(t,"offset")}}(t)).location?t.location instanceof vt||t.location instanceof wt?t.location.ids:this.grid.tileByCoords(t.location).ids:void 0;let e=new yt({ids:this.ids,location:i,Vt:t.Vt,offset:t.offset||{top:"0",right:"0",bottom:"0",left:"0"}});return this.contents.push(e),this.Ft&&this.Mt&&e.render(),new vt(e)}deleteContent(t){let i=this.contentByElement(t)||this.contentById(t);return!!i&&(this.contents.splice(this.contents.indexOf(i),1),!0)}toggleRenderOnChange(t){return this.Ft=void 0!==t?t:!this.Ft,this.Ft}}class Ct extends bt{set style(t){this.St=t}get style(){return this.St}get _(){return{map:this.style.M,grid:this.style.grid.M,R:this.style.grid.R.M}}constructor(t,i){super(t),t.grid.ids&&"number"==typeof t.grid.ids.grid?this.grid=i.import(t.grid):this.grid=new i(Object.assign(t.grid,{ids:this.ids})),this.hi(t._),t.grid.tiles&&this.grid.oi(function(t){let i=new $;if(g(t))for(const e in t)i[Number(e)]=y(t[e]);return i}(t.grid.tiles))}static Pt(t,i){let e=new t(i);return e.Nt(i.extensions),e}Nt(t){m(this.extensions,t)}Ot(t){b(this.extensions,t)}kt(t={}){var i;return W(t,[["type",this.ri()],["ids",D(this.ids)],["grid",this.grid.export()],["schema",(i=this._,W({},[["map",et(i.map)],["grid",rt(i.grid)],["tile",ht(i.R)]]))],["contents",this.contents.map((t=>t.export()))]]),t}Lt(t={}){return W(t,[["extensions",this.extensions]]),t}render(t){this.elements=this.Bt(),this.ni(t),this.grid.render(this.elements.map),this.style.render();for(let t of this.contents)t.render();this.Mt=!0}}class Et{set ids(t){this.I=t}get ids(){return this.I}get map(){return Y.map.grid(this.ids)}get size(){return{width:this.lt.x.max-this.lt.x.min+1,height:this.lt.y.max-this.lt.y.min+1}}get lt(){let t,i,e,s;for(let r of this.tiles.keys){(void 0===t||r<t)&&(t=r),(void 0===i||r>i)&&(i=r);for(let t of this.tiles[r].keys)(void 0===e||t<e)&&(e=t),(void 0===s||t>s)&&(s=t)}return{x:{min:e||0,max:s||0},y:{min:t||0,max:i||0}}}Tt(t){if(this.J.ids.R===t.R)return this.J;for(let i in this.tiles)for(let e in this.tiles[i])if(this.tiles[i][e].ids.R===t.R)return this.tiles[i][e]}get style(){return Y.map.grid(this.ids).style.grid}get _(){return{grid:this.style.M,R:this.style.R.M}}get j(){let t="elemap-",i=t+"grid";return{frame:i+"-frame",F:i+"-frame-outer",B:i+"-frame-inner",grid:i,G:i+"-outer",Y:i+"-inner",V:i+"-contour",J:t+"mannequin",H:t+"row",R:t+"tile",K:t+"tile-hidden"}}get o(){return this.style.o}set orientation(t){this.ui=t}get orientation(){return this.ui}set offset(t){this.Ut=t}get offset(){return this.Ut}set elements(t){this.qt=t}get elements(){return this.qt}set extensions(t){this.It=t}get extensions(){return this.It}constructor(t){this.tiles=new $,this.It={},"number"==typeof t.ids.grid?(this.ids=new k(t.ids,t.ids.grid),Y.update(this.ids.grid)):this.ids=new k(t.ids,Y.id()),this.orientation=t.orientation,this.offset=t.offset}static Pt(t,i){let e=new t(i);return e.Nt(i.extensions),e}Nt(t){m(this.extensions,t)}Ot(t){b(this.extensions,t)}Rt(){return this.Lt(this.kt())}kt(t={}){let i=new x;for(let[t,e]of this.tiles){i[t]=new x;for(let[s,r]of e)i[t][s]=r.export()}var e;return W(t,[["ids",V(this.ids)],["orientation",this.orientation],["offset",this.offset],["schema",(e=this._,W({},[["grid",rt(e.grid)],["tile",ht(e.R)]]))],["tiles",i]]),t}Lt(t={}){return W(t,[["extensions",this.extensions]]),t}oi(t){for(let[i,e]of t)for(let[t,s]of e)this.tiles[i]||(this.tiles[i]=new x),this.tiles[i][t]=this.li(s)}Bt(){this.elements||(this.elements={F:document.createElement("div"),B:document.createElement("div"),tt:document.createElement("div"),inner:document.createElement("div"),jt:new x,Gt:new x,V:document.createElement("div"),dt:document.createElement("div"),J:{X:document.createElement("div"),W:document.createElement("div"),Z:document.createElement("div"),D:document.createElement("div")}},this.elements.F.classList.add(this.j.F),this.map.Xt(this.elements.F),this.elements.B.classList.add(this.j.B),this.map.Xt(this.elements.B),this.elements.F.appendChild(this.elements.B),this.elements.tt.classList.add(this.j.grid),this.elements.tt.classList.add(this.j.G),this.map.Xt(this.elements.tt),this.elements.inner.classList.add(this.j.grid),this.elements.inner.classList.add(this.j.Y),this.map.Xt(this.elements.inner),this.elements.V.classList.add(this.j.V),this.elements.V.appendChild(this.elements.dt),this.map.Xt(this.elements.V),this.elements.J.X.classList.add(this.j.J),this.elements.J.X.classList.add(this.j.H),this.map.Xt(this.elements.J.X),this.elements.tt.appendChild(this.elements.J.X),this.elements.J.Z.classList.add(this.j.J),this.elements.J.Z.classList.add(this.j.H),this.map.Xt(this.elements.J.Z),this.elements.inner.appendChild(this.elements.J.Z),this.style.R.i.render())}render(t){this.Bt(),t.innerHTML="";for(let t in this.elements.jt)for(let i of this.elements.jt[t].children)this.di(i)||this.elements.jt[t].removeChild(i);for(let t in this.elements.Gt)for(let i of this.elements.Gt[t].children)this.di(i)||this.elements.Gt[t].removeChild(i);for(let[t,i]of this.tiles){void 0===this.elements.jt[t]&&(this.elements.jt[t]=document.createElement("div"),this.elements.jt[t].classList.add(this.j.H),Z(this.elements.jt[t].dataset,"coordsY",t.toString()),this.elements.tt.appendChild(this.elements.jt[t])),void 0===this.elements.Gt[t]&&(this.elements.Gt[t]=document.createElement("div"),this.elements.Gt[t].classList.add(this.j.H),Z(this.elements.Gt[t].dataset,"coordsY",t.toString()),this.elements.inner.appendChild(this.elements.Gt[t]));for(let t of i.values)t.render()}t.appendChild(this.elements.F),t.appendChild(this.elements.tt),t.appendChild(this.elements.inner),t.appendChild(this.elements.V),this.elements.inner.addEventListener("mouseover",(t=>{let i=t.target.closest(this.o.D);i&&this.di(i).bt()})),this.elements.inner.addEventListener("mouseout",(t=>{let i=t.target.closest(this.o.D);i&&this.di(i).Dt()}))}Zt(t){!1===t?this.elements.dt.removeAttribute("style"):(this.elements.dt.style.display="block",this.elements.dt.style.transform=`translate(${t.x}px, ${t.y}px)`)}}class Tt extends e{set ids(t){this.I=t}get ids(){return this.I}get i(){return Y.R.h(this.ids.i)}get grid(){return Y.style.grid(this.ids.i)}get spacing(){return this.grid.spacing}set N(t){this.O=t}get N(){return this.O||this.compute(),this.O}get o(){return Object.assign(Object.assign({},this.grid.o),{data:this.J?"":this.i.o.data})}set M(t){this.P=t}get M(){return this.P}constructor(t,i,e,s=!1){super(),this.ids=new G(t,i,Y.id()),this.J=s,this.M=e}get size(){let t={width:this.N.inner.width,height:this.N.inner.height};return{rt:{width:A(t.width,M(this.spacing,2)),height:A(t.height,M(this.spacing,2))},tt:{width:A(t.width,this.spacing),height:A(t.height,this.spacing)},inner:t}}get U(){return""}get _(){let t="";return this.M.tt.length&&(t+=this.o.W+this.o.data+"{"+this.M.tt+"}"),this.M.inner.length&&(t+=this.o.D+this.o.data+"{"+this.M.inner+"}"),this.M.bt.tt.length&&(t+=this.o.W+this.o.data+":hover{"+this.M.bt.tt+"}"),this.M.bt.inner.length&&(t+=this.o.D+this.o.data+":hover{"+this.M.bt.inner+"}"),t}get it(){return""}compute(){this.N={inner:getComputedStyle(this.i.elements.inner)}}get ai(){return this.grid.ct(this.i.gt)}get ci(){return this.grid.ft(this.i.gt)}}class St extends Tt{}class qt extends $t{constructor(t){super(t)}get gt(){return this.coords}static import(t){return this.Pt(qt,t)}export(){return this.Rt()}set style(t){this.St=t}get style(){return void 0!==this.St?this.St:Y.style.R(this.ids)}Qt(t){return new St(this.ids,this.grid.style.ids,t)}Yt(){this.elements.tt&&(Z(this.elements.tt.dataset,"coordsX",this.coords.x.toString()),Z(this.elements.tt.dataset,"coordsY",this.coords.y.toString())),Z(this.elements.inner.dataset,"coordsX",this.coords.x.toString()),Z(this.elements.inner.dataset,"coordsY",this.coords.y.toString())}get o(){return{data:`[data-coords-x="${this.coords.x}"][data-coords-y="${this.coords.y}"]`}}get neighborCoords(){return[{x:(t=this.coords).x,y:t.y+1},{x:t.x+1,y:t.y},{x:t.x,y:t.y-1},{x:t.x-1,y:t.y}];var t}get neighbors(){let t=[];for(let i of this.neighborCoords){let e=this.grid.tileByCoords(i);e&&t.push(e)}return t}get diagonalCoords(){return[{x:(t=this.coords).x+1,y:t.y-1},{x:t.x+1,y:t.y+1},{x:t.x-1,y:t.y+1},{x:t.x-1,y:t.y-1}];var t}get diagonals(){let t=[];for(let i of this.diagonalCoords){let e=this.grid.tileByCoords(i);e&&t.push(e)}return t}distanceToCoords(t,i){return t=this.grid.fi(t),function(t,i,e){let s=Math.abs(t.x-i.x),r=Math.abs(t.y-i.y);return e?Math.max(s,r):s+r}(this.coords,t,i)}alignedWithCoords(t,i){return t=this.grid.fi(t),function(t,i,e){return t.x===i.x||t.y===i.y||!(!e||Math.abs(t.x-i.x)!==Math.abs(t.y-i.y))}(this.coords,t,i)}}class zt extends Et{constructor(t){super(t)}static import(t){return this.Pt(zt,t)}export(){return this.Rt()}pi(t){return new qt(t)}li(t){return qt.import(t)}gi(t){return t}createTile(t,i){return Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.tiles[t.y]||(this.tiles[t.y]=new x),!(!i&&this.tiles[t.y][t.x])&&(this.tiles[t.y][t.x]=this.pi({ids:this.ids,coords:this.gi(t),M:!1}),this.map.Ft&&this.map.Mt&&this.map.render(),t)}createTiles(t,i,e){i=s(i);let r=[];Array.isArray(t)&&(t={x:t[0],y:t[1]});for(let s=t.x;s<t.x+i.width;s++)for(let n=t.y;n<t.y+i.height;n++)r.push(this.createTile({x:s,y:n},e));return r.length>0&&this.map.Ft&&this.map.Mt&&this.map.render(),r}tileByCoords(t){if(Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.tiles[t.y]&&this.tiles[t.y][t.x])return this.tiles[t.y][t.x]}di(t){if(t.hasAttribute("data-coords-x")&&t.hasAttribute("data-coords-y")){let i=this.tileByCoords({x:Number(t.getAttribute("data-coords-x")),y:Number(t.getAttribute("data-coords-y"))});if(i&&i.elements&&(i.elements.inner&&i.elements.inner===t||i.elements.tt&&i.elements.tt===t))return i}}fi(t){return Array.isArray(t)&&(t={x:t[0],y:t[1]}),t}deleteTile(t){let i=this.tileByCoords(t);return!!i&&(this.tiles.delete([i.coords.y,i.coords.x]),this.map.Ft&&this.map.Mt&&this.map.render(),!0)}deleteTiles(t,i){i=s(i);let e=[];Array.isArray(t)&&(t={x:t[0],y:t[1]});for(let s=t.x;s<t.x+i.width;s++)for(let r=t.y;r<t.y+i.height;r++)e.push(this.deleteTile({x:s,y:r}));return e.length>0&&this.map.Ft&&this.map.Mt&&this.map.render(),e}}class At extends e{set ids(t){this.I=t}get ids(){return this.I}set M(t){this.P=t}get M(){return this.P}set elements(t){this.qt=t}get elements(){return this.qt}set N(t){this.O=t}get N(){return this.O}get i(){return Y.map.grid(this.ids.i)}constructor(t,i){super(),this.ids=new H(t,Y.id()),this.M=i.map}export(){return W(this.M,[["outer",this.M.tt],["inner",this.M.inner]])}Bt(){let t,i,e,s=document.head.getElementsByTagName("style");for(let r of s)r.classList.contains(this.i.j.u+"css-core")&&r.hasAttribute("data-map-id")&&r.getAttribute("data-map-id")===this.ids.i.map.toString()?t=r:r.classList.contains(this.i.j.u+"css-schema")&&r.hasAttribute("data-map-id")&&r.getAttribute("data-map-id")===this.ids.i.map.toString()?i=r:r.classList.contains(this.i.j.u+"css-generated")&&r.hasAttribute("data-map-id")&&r.getAttribute("data-map-id")===this.ids.i.map.toString()&&(e=r);return t||(t=document.createElement("style"),t.classList.add(this.i.j.u+"css-core"),this.i.Xt(t),document.head.appendChild(t)),i||(i=document.createElement("style"),i.classList.add(this.i.j.u+"css-schema"),this.i.Xt(i),document.head.appendChild(i)),e||(e=document.createElement("style"),e.classList.add(this.i.j.u+"css-generated"),this.i.Xt(e),document.head.appendChild(e)),{U:t,_:i,it:e}}render(){this.elements=this.Bt(),this.elements.U.innerHTML=this.U,this.elements._.innerHTML=this._,this.i.elements.map.offsetHeight,this.compute(),this.elements.it.innerHTML=this.it}get o(){let t='[data-map-id="'+this.ids.i.map+'"]';return{u:".elemap",container:".elemap-container"+t,map:".elemap-map"+t,content:".elemap-content"+t}}get U(){return this.o.container+"{width:max-content;position:relative;}"+this.o.map+"{position:relative;width:max-content;z-index:10;display: flex;}"+this.o.content+"{position:absolute;z-index:500;top:0;left:0;bottom:0;right:0;pointer-events:none;}"+this.o.content+">div{width:0px;height:0px;position:absolute;overflow:visible;}"+this.o.content+">div>div{position:absolute;transform:translate(-50%, -100%);}"+this.o.content+">div>div>*{pointer-events:auto;}"}get _(){return this.o.map+"{"+this.M.tt+"}"+this.o.map+">*{"+this.M.inner+"}"}compute(){this.N={map:getComputedStyle(this.i.elements.map)}}get it(){return""}}class It extends At{set grid(t){this.mi=t}get grid(){return this.mi}constructor(t,i){super(t,i),this.xi(i)}render(){this.elements=this.Bt(),this.elements.U.innerHTML=this.U+this.grid.U+this.grid.R.U,this.elements._.innerHTML=this._+this.grid._+this.grid.R._,this.i.elements.map.offsetHeight,this.i.grid.elements.inner.offsetHeight,this.compute(),this.elements.it.innerHTML=this.it+this.grid.it+this.grid.R.it,this.grid.$t();let t=document.head.getElementsByTagName("style"),i=Array.from(t);for(let t of i)for(let i of t.classList)if(i.startsWith(this.i.j.u+"css-")){let i=!1;if(t!==this.elements.U&&t!==this.elements._&&t!==this.elements.it||(i=!0),!i)for(let e of this.grid.i.tiles.values){for(let s of e.values)if(t===s.elements.style){i=!0;break}if(i)break}i||t.remove()}}compute(){this.N={map:getComputedStyle(this.i.elements.map)},this.grid.compute()}}class Mt extends O{get i(){return Y.grid.Ct(this.ids.i)}set R(t){this.L=t}get R(){return this.L}k(t){this.i.J=new qt({ids:this.i.ids,coords:{x:0,y:0},M:"mannequin"}),this.R=new St(this.i.J.ids,this.ids,t,!0)}get ut(){let t=l(T(this.N.dt.borderWidth),0)+"px",i={width:I(this.R.size.rt.width,M(t,2)),height:I(this.R.size.rt.height,M(t,2))},e=c(this.R.size.rt,T(this.R.N.inner.borderRadius)),s=c(i,T(this.R.N.inner.borderRadius),{top:T(t),left:T(t)});return this.o.V+">div{"+`clip-path:path(evenodd,'${e} ${s}');}`}get nt(){let t="",i=this.i.lt;for(let e=i.y.min;e<=i.y.max;e++)for(let s=i.x.min;s<=i.x.max;s++){if(!this.i.tiles[e]||!this.i.tiles[e][s]||!this.i.tiles[e][s].visible)continue;""!==t&&(t+=" ");let i=this.ct({x:s,y:e});t+=c(this.R.size.rt,T(this.R.N.inner.borderRadius),{top:T(i.top),left:T(i.left)})}return t}}class Pt extends It{xi(t){this.grid=new Mt(this.i.grid.ids,this.ids,t)}}class Nt extends Ct{constructor(t){super(t,zt)}static import(t){return this.Pt(Nt,t)}export(){return this.Rt()}ri(){return`${r.p}`}hi(t){this.style=new Pt(this.ids,t)}}class Ot extends Tt{}class Rt extends $t{constructor(t){super(t)}get gt(){let t=p(this.coords,this.grid.orientation,this.grid.offset);return{x:t.x,y:t.y}}static import(t){return this.Pt(Rt,t)}export(){return this.Rt()}set style(t){this.St=t}get style(){return void 0!==this.St?this.St:Y.style.R(this.ids)}Qt(t){return new Ot(this.ids,this.grid.style.ids,t)}Yt(){this.elements.tt&&(Z(this.elements.tt.dataset,"coordsR",this.coords.r.toString()),Z(this.elements.tt.dataset,"coordsQ",this.coords.l.toString())),Z(this.elements.inner.dataset,"coordsR",this.coords.r.toString()),Z(this.elements.inner.dataset,"coordsQ",this.coords.l.toString()),this.elements.tt&&(Z(this.elements.tt.dataset,"coordsX",this.gt.x.toString()),Z(this.elements.tt.dataset,"coordsY",this.gt.y.toString())),Z(this.elements.inner.dataset,"coordsX",this.gt.x.toString()),Z(this.elements.inner.dataset,"coordsY",this.gt.y.toString())}get o(){return{data:`[data-coords-r="${this.coords.r}"][data-coords-q="${this.coords.l}"]`}}get neighborCoords(){return[{l:(t=this.coords).l+1,r:t.r-1},{l:t.l+1,r:t.r},{l:t.l,r:t.r+1},{l:t.l-1,r:t.r+1},{l:t.l-1,r:t.r},{l:t.l,r:t.r-1}];var t}get neighbors(){let t=[];for(let i of this.neighborCoords){let e=this.grid.tileByCoords(i);e&&t.push(e)}return t}get diagonalCoords(){return[]}get diagonals(){return[]}distanceToCoords(t){return o(t=this.grid.fi(t))&&(t=f(t,this.grid.orientation,this.grid.offset)),i=this.coords,e=t,(Math.abs(i.l-e.l)+Math.abs(i.l+i.r-e.l-e.r)+Math.abs(i.r-e.r))/2;var i,e}alignedWithCoords(t){return o(t=this.grid.fi(t))&&(t=f(t,this.grid.orientation,this.grid.offset)),e=t,(i=this.coords).l===e.l||i.r===e.r||i.l+i.r===e.l+e.r;var i,e}}class Lt extends Et{constructor(t){super(t)}static import(t){return this.Pt(Lt,t)}export(){return this.Rt()}pi(t){return new Rt(t)}li(t){return Rt.import(t)}gi(t){return f(t,this.orientation,this.offset)}tileByCoords(t){Array.isArray(t)&&(t={l:t[0],r:t[1]});let i=o(t)?t:p(t,this.orientation,this.offset);if(this.tiles[i.y]&&this.tiles[i.y][i.x])return this.tiles[i.y][i.x]}di(t){if(t.hasAttribute("data-coords-r")&&t.hasAttribute("data-coords-q")){let i=this.tileByCoords({l:Number(t.getAttribute("data-coords-q")),r:Number(t.getAttribute("data-coords-r"))});if(i&&i.elements&&(i.elements.inner&&i.elements.inner===t||i.elements.tt&&i.elements.tt===t))return i}}createTile(t,i){Array.isArray(t)&&(t={l:t[0],r:t[1]});let e=o(t)?t:p(t,this.orientation,this.offset);return this.tiles[e.y]||(this.tiles[e.y]=new x),!(!i&&this.tiles[e.y][e.x])&&(this.tiles[e.y][e.x]=this.pi({ids:this.ids,coords:this.gi(e),M:!1}),this.map.Ft&&this.map.Mt&&this.map.render(),t)}createTiles(t,i,e){i=s(i);let r=[];if(Array.isArray(t)&&(t={l:t[0],r:t[1]}),o(t))for(let s=t.x;s<t.x+i.width;s++)for(let n=t.y;n<t.y+i.height;n++)r.push(this.createTile(f({x:s,y:n},this.orientation,this.offset),e));else for(let s=t.l;s<t.l+i.width;s++)for(let n=t.r;n<t.r+i.height;n++)r.push(this.createTile({l:s,r:n},e));return r.length>0&&this.map.Ft&&this.map.Mt&&this.map.render(),r}$i(t){return this.offset===h.C?t%2!=0:t%2==0}fi(t){return Array.isArray(t)&&(t={l:t[0],r:t[1]}),t}deleteTile(t){let i=this.tileByCoords(t);return!!i&&(this.tiles.delete([i.coords.r,i.coords.l]),this.map.Ft&&this.map.Mt&&this.map.render(),!0)}deleteTiles(t,i){i=s(i);let e=[];Array.isArray(t)&&(t={l:t[0],r:t[1]});for(let s=t.l;s<t.l+i.width;s++)for(let r=t.r;r<t.r+i.height;r++)e.push(this.deleteTile({l:s,r}));return e.length>0&&this.map.Ft&&this.map.Mt&&this.map.render(),e}}class kt extends O{get i(){return Y.grid.Et(this.ids.i)}set R(t){this.L=t}get R(){return this.L}k(t){this.i.J=new Rt({ids:this.i.ids,coords:{l:0,r:0},M:"mannequin"}),this.R=new Ot(this.i.J.ids,this.ids,t,!0)}get yi(){return this.i.orientation===n.$?{rt:{S:P(this.R.size.rt.height,2),A:this.R.size.rt.height,q:this.R.size.rt.width},tt:{S:P(this.R.size.tt.height,2),A:this.R.size.tt.height,q:this.R.size.tt.width},inner:{S:P(this.R.size.inner.height,2),A:this.R.size.inner.height,q:this.R.size.inner.width}}:{rt:{S:P(this.R.size.rt.width,2),A:this.R.size.rt.width,q:this.R.size.rt.height},tt:{S:P(this.R.size.tt.width,2),A:this.R.size.tt.width,q:this.R.size.tt.height},inner:{S:P(this.R.size.inner.width,2),A:this.R.size.inner.width,q:this.R.size.inner.height}}}compute(){this.N={tt:getComputedStyle(this.i.elements.tt),inner:getComputedStyle(this.i.elements.inner),dt:getComputedStyle(this.i.elements.dt)},this.R.compute(),this.wi(),this.R.compute()}wi(){let t,i;this.i.orientation===n.$?(i=I(this.R.size.tt.height,this.R.size.inner.height),t=N(M(this.R.size.inner.width,d),0),this.map.elements._.innerHTML+=this.o.W+"{height:"+A(t,i)+"}"+this.o.D+"{height:"+t+"}"):(i=I(this.R.size.tt.width,this.R.size.inner.width),t=N(M(this.R.size.inner.height,d),0),this.map.elements._.innerHTML+=this.o.W+"{width:"+A(t,i)+"}"+this.o.D+"{width:"+t+"}")}get nt(){let t="",i=this.i.lt;for(let e=i.y.min;e<=i.y.max;e++)for(let s=i.x.min;s<=i.x.max;s++){if(!this.i.tiles[e]||!this.i.tiles[e][s]||!this.i.tiles[e][s].visible)continue;""!==t&&(t+=" ");let i=this.ct({x:s,y:e});t+=a(this.i.orientation,this.yi.rt,T(this.R.N.inner.borderRadius),{top:T(i.top),left:T(i.left)})}return t}get ut(){let t=l(T(this.N.dt.borderWidth),0)+"px",i=I(this.yi.rt.A,M(t,2)),e={S:P(i,2),A:i,q:I(this.yi.rt.q,M(t,2))},s=a(this.i.orientation,this.yi.rt,T(this.R.N.inner.borderRadius)),r=a(this.i.orientation,e,T(this.R.N.inner.borderRadius),{top:T(t),left:T(t)});return this.o.D+"{"+`clip-path:path('${a(this.i.orientation,this.yi.inner,T(this.R.N.inner.borderRadius))}');}`+this.o.W+"{"+`clip-path:path('${a(this.i.orientation,this.yi.tt,0)}');}`+this.o.V+">div{"+`clip-path:path(evenodd,'${s} ${r}');}`+this.bi()}get Ci(){return this.i.orientation===n.$?{vertical:P(this.R.size.tt.height,4),Ei:"0px"}:{vertical:"0px",Ei:P(this.R.size.tt.width,4)}}Ti(){let t=!1,i=!1;for(let e of this.i.tiles.values){for(let s of e.values)this.Si(s.gt)?t=!0:i=!0;if(t&&i)break}return t&&i}qi(){let t=this.i.lt;for(let i of this.i.tiles.values)for(let e of i.values)if(!this.Si(e.gt)){if(this.i.orientation===n.$&&e.gt.x===t.x.min)return!0;if(this.i.orientation===n.v&&e.gt.y===t.y.min)return!0}return!1}zi(){let t=this.i.lt;for(let i of this.i.tiles.values)for(let e of i.values)if(this.Si(e.gt)){if(this.i.orientation===n.$&&e.gt.x===t.x.max)return!0;if(this.i.orientation===n.v&&e.gt.y===t.y.max)return!0}return!1}Si(t){return this.i.orientation===n.$?"even"===this.i.offset&&t.y%2==0||"odd"===this.i.offset&&t.y%2!=0:"even"===this.i.offset&&t.x%2==0||"odd"===this.i.offset&&t.x%2!=0}Ai(t){let i={vertical:"0px",Ei:"0px"};return this.Ti()?(this.i.orientation===n.$?this.qi()?this.Si(t)&&(i.Ei=this.Ii.Ei):this.Si(t)||(i.Ei=I(0,this.Ii.Ei)):this.qi()?this.Si(t)&&(i.vertical=this.Ii.vertical):this.Si(t)||(i.vertical=I(0,this.Ii.vertical)),i):i}bi(){let t="";if(!this.Ti())return t;let i=this.i.lt;if(this.i.orientation===n.$)for(let e=i.y.min;e<=i.y.max;e++)t+=this.o.H+`[data-coords-y="${e}"]{`+`left:${this.Ai({x:i.x.min,y:e}).Ei};}`;else for(let e=i.x.min;e<=i.x.max;e++)t+=this.o.R+`[data-coords-x="${e}"]{`+`top:${this.Ai({x:e,y:i.y.min}).vertical};}`;return t}get Ii(){return this.i.orientation===n.$?{vertical:"0px",Ei:P(this.R.size.tt.width,2)}:{vertical:P(this.R.size.tt.height,2),Ei:"0px"}}get ht(){let t="",i=this.i.lt;for(let e=i.y.min;e<=i.y.max;e++)this.i.tiles[e]&&(t+=this.o.H+`[data-coords-y="${e}"]{`+`top:${I(M(e-i.y.min,this.R.size.tt.height),M(this.Ci.vertical,e-i.y.min))};}`);return t}get st(){return{width:I(M(this.R.size.tt.width,this.i.size.width),M(this.Ci.Ei,this.i.size.width-1)),height:this.R.size.tt.height}}get et(){let t=this.st.width;this.i.orientation===n.$&&this.Ti()&&(this.qi()&&this.zi()?t=A(t,this.Ii.Ei):this.qi()||this.zi()||(t=I(t,this.Ii.Ei)));let i=I(M(this.R.size.tt.height,this.i.size.height),M(this.Ci.vertical,this.i.size.height-1));return this.i.orientation===n.v&&this.Ti()&&(this.qi()&&this.zi()?i=A(i,this.Ii.vertical):this.qi()||this.zi()||(i=I(i,this.Ii.vertical))),{width:t,height:i}}ct(t){let i=t.x-this.i.lt.x.min,e=t.y-this.i.lt.y.min,s=I(this.R.size.tt.height,this.Ci.vertical),r=I(this.R.size.tt.width,this.Ci.Ei);return{top:A(M(e,s),this.Ai(t).vertical),left:A(M(i,r),this.Ai(t).Ei)}}ft(t){let i=this.ct(t);return{top:A(i.top,P(this.spacing,2)),left:A(i.left,P(this.spacing,2))}}get ot(){let t="";for(let i of this.i.tiles.values)for(let e of i.values)t+=this.o.R+e.o.data+"{"+`left:${I(this.ct(e.gt).left,this.Ai(e.gt).Ei)};}`;return t}}class Qt extends It{xi(t){this.grid=new kt(this.i.grid.ids,this.ids,t)}}class Ft extends Ct{constructor(t){super(t,Lt)}static import(t){return this.Pt(Ft,t)}export(){return this.Rt()}ri(){return`${r.m}`}hi(t){this.style=new Qt(this.ids,t)}}function Bt(t){let i=X(t,"grid");return{ids:(s=X(t,"ids"),{map:X(s,"map")}),grid:{ids:J(X(i,"ids")),orientation:X(i,"orientation")||n.$,offset:X(i,"offset")||h.C,_:ut(X(i,"schema")),tiles:X(i,"tiles")},_:(e=lt(X(t,"schema"))||{},{map:ft(e.map||{},ct),grid:gt(e.grid||{},pt),R:xt(e.R||{},mt)}),contents:X(t,"contents")||[]};var e,s}class Ht{constructor(t){this._t=t}get ids(){return V(this._t.ids)}export(){return this._t.export()}get extensions(){return this._t.extensions}Nt(t){return this._t.Nt(w(t))}Ot(t){return this._t.Ot(t)}tileByCoords(t){let i=this._t.tileByCoords(Array.isArray(t)?t:dt(t));if(i)return new wt(i)}createTile(t,i=!1){let e=this._t.createTile(t,i);return e&&this.tileByCoords(e)||!1}createTiles(t,i,e=!1){let s=this._t.createTiles(t,i,e),r=[];for(let t of s)t?r.push(this.tileByCoords(t)||!1):r.push(!1);return r}get tiles(){let t=new $;for(let[i,e]of this._t.tiles){t[i]=new x;for(let[s,r]of e)t[i][s]=new wt(r)}return t}deleteTile(t){return this._t.deleteTile(Array.isArray(t)?t:dt(t))}deleteTiles(t,i){return this._t.deleteTiles(Array.isArray(t)?t:dt(t),i)}}class jt{constructor(t,i){let e=t===r.p?r.p:t===r.m?r.m:r.p;e===r.p?this._t=new Nt(Bt(i||{})):e===r.m&&(this._t=new Ft(Bt(i||{})))}get ids(){return D(this._t.ids)}static import(t){return new jt(t.type,t)}export(){return this._t.export()}get extensions(){return this._t.extensions}Nt(t){return this._t.Nt(w(t))}Ot(t){return this._t.Ot(t)}render(t){this._t.render(t)}get grid(){let t=this._t.grid;if(t)return new Ht(t)}addContent(t){return this._t.addContent(t)}deleteContent(t){return this._t.deleteContent(t)}contentById(t){let i=this._t.contentById(t);if(i)return new vt(i)}contentByElement(t){let i=this._t.contentByElement(t);if(i)return new vt(i)}get contents(){let t=[];for(let i of this._t.contents)t.push(new vt(i));return t}static get Mi(){return{p:r.p,m:r.m}}static get Pi(){return{$:n.$,v:n.v}}static get Ni(){return{C:h.C,T:h.T}}toggleRenderOnChange(t){return this._t.toggleRenderOnChange(t)}}const Gt=jt})(),Elemap=i.default})();